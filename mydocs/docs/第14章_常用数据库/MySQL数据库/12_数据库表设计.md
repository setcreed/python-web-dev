## 数据库设计

> 关系型数据库建议在E-R模型的基础上，我们需要根据产品经理的设计策划，抽取出来模型与关系，制定出表结构，这是项目开始的第一步。
>
> 在开发中有很多设计数据库的软件，常用的如power designer，db designer等，这些软件可以直观的看到实体及实体间的关系。
>
> 设计数据库，可能是由专门的数据库设计人员完成，也可能是由开发组成员完成，一般是项目经理领组员完成。

## 三范式

经过研究和对使用中问题的总结，对于设计数据库提出了一些规范，这些规范被称为范式（Normal Form）

目前有迹可循的共有8种范式，一般需要遵循3范式即可：

## 第一范式（1NF）：

第一范式是最基本的范式，强调的是列的原子性，即列不能再分成其他几列

![](https://cdn.jsdelivr.net/gh/setcreed/pic_img/cdn_img/20200201204726.png)
上图不符合第一范式，买家地址可以拆分

![](https://cdn.jsdelivr.net/gh/setcreed/pic_img/cdn_img/20200201204746.png)

这样修改就遵循了第一范式。修改后的订单表 在用户使用城市进行分类的时候会非常方便，提高了数据库性能

## 第二范式（2NF）：

首先是基于第一范式，另外包含两部分内容，一是表必须有一个主键；二是没有包含在主键中的列必须完全依赖于主键，而不能只依赖主键的一部分。**也就是说在一个数据表中，只能保存一种数据，不能把多种数据保存在同一张表中。**

上面的订单表可以继续拆分

![](https://cdn.jsdelivr.net/gh/setcreed/pic_img/cdn_img/20200201204804.png)

## 第三范式（3NF）：

首先是基于第二范式，另外非主键列必须直接依赖于主键，不能存在传递依赖。 **确保数据表中每一列数据都和主键直接相关，而不能间接相关。**要求一个关系中不包含在其他关系已包含的非主键字段信息。

上图看出，虽然单价和商品直接相关，但单价不与订单直接相关，不符合第三范式，还可以继续拆分。

![](https://cdn.jsdelivr.net/gh/setcreed/pic_img/cdn_img/20200201204830.png)

# E-R模型

- E表示Entity，实体，设计实体就像定义一个类一样，指定从哪些方面描述对象一个实体转换为数据库中的一个表
- R表示relationship，关系，关系描述两个实体之间的对应规则，关系的类型包括一对一、一对多、多对多
- 关系也是一种数据，需要通过一个字段存储在表中
- 实体A对实体B为1对1，则在表A或表B中创建一个字段，存储另一个表的主键值
- 实体A对实体B为1对多：在表中创建一个字段，存储表A的主键值
- 实体A对实体B为多对多：新建一张表C，这个表只有两个字段，一个用于存储A的主键值，一个用于存储B的主键值